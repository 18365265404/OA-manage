<template>
	<div>
		<div class="wrap baby2" id="ddd">
			<p class="top_number">№<label id="agreementNo"></label></p>
			<p class="top_title">“宝宝宴”宴会服务协议书</p>
			<table class="table1" width="100%" cellspacing="0" cellpadding="0">
				<tr>
					<td>甲方</td>
					<td colspan="3" style="font-weight: inherit"><label id="partyA"></label></td>
				</tr>
				<tr>
					<td>协调人</td>
					<td style="font-weight: inherit"><label id="partyAContacts"></label></td>
					<td>协调人联系方式</td>
					<td style="font-weight: inherit"><label id="partyAMobile"></label></td>
				</tr>
				<tr>
					<td>乙方</td>
					<td colspan="3" style="font-weight: inherit"><label id="partyB"></label></td>
				</tr>
				<tr>
					<td>协调人</td>
					<td style="font-weight: inherit"><label id="partyBContacts"></label></td>
					<td>协调人联系方式</td>
					<td style="font-weight: inherit"><label id="partyBMobile"></label></td>
				</tr>
				<tr>
					<td>地址</td>
					<td colspan="3" style="font-weight: inherit"><label id="partyBAddress"></label></td>
				</tr>
			</table>

			<p>根据《中华人民共和国合同法》及相关法律法规的规定，甲、乙双方经友好协商，就甲方在乙方场地举办会议活动相关事宜达成如下协议，并共同遵照执行。</p>

			<p class="bady_care">一、活动基本信息</p>
			<p>甲方确认其向乙方预订宴会活动基本信息如下表所示</p>
			<table class="table2" width="100%" cellspacing="0" cellpadding="0">
				<tr>
					<td>活动日期</td>
					<td style="font-weight: inherit"><label id="scheduleTime"></label></td>
					<td>预计桌数</td>
					<td style="font-weight: inherit"><label id="estimateTableNumber"></label></td>
					<td>保证桌数</td>
					<td style="font-weight: inherit"><label id="tableNumber"></label></td>
				</tr>
				<tr>
					<td>宴会厅</td>
					<td style="font-weight: inherit"><label id="banquetHallName"></label></td>
					<td>起止时间</td>
					<td style="font-weight: inherit"><label id="time"></label></td>
					<td>餐桌形式</td>
					<td style="font-weight: inherit"><label id="diningTableFormName"></label></td>
				</tr>
			</table>

			<p class="bady_care">二、服务内容及报价</p>
			<p>甲方预订“宝宝宴”宴会服务的信息、所选套餐包含的服务项目及报价详见本协议附件《服务项目及报价清单》。</p>

			<p class="bady_care">三、付款方式</p>
			<div class=" dataGoldDiv">

			</div>

			<p class="bady_care">四、双方权力义务及服务保障</p>
			<p class="bady_care_p">4.1甲方应按本协议约定，按时、足额向乙方支付相应费用。</p>
			<p class="bady_care_p">4.2 甲方应积极协助乙方完成各项准备工作，提供相关资料和素材，并在约定的时间到乙方处进行商谈，确保宴会顺利进行。</p>
			<p class="bady_care_p">4.3 乙方应严格遵守合同的约定，安全、有效、保质保量、及时地完成各服务项目。 </p>
			<p class="bady_care_p">4.4 乙方对食品卫生负有责任，若单个菜品发生食品质量问题，经调查属实,乙方须为甲方调换相同的符合质量标准的食品,也可按单个菜品的原价退款。甲方消费者因用餐健康受到损害，经有关部门鉴定属实，乙方应当给予赔偿。</p>
			<p class="bady_care_p">4.5 由于不可抗力的原因，如台风、地震、洪水、罢工、骚乱、政府征收征用、市政部门原因引起的大面积停电及非因乙方故意引起的火灾等， 导致本协议无法执行，乙方有权终止本协议，并将已付定金退还给甲方。或者经双方协商，在不退换定金的情况下，乙方可提供所有分店合适的宴会厅与档期供甲方挑选使用。在此种情况下，乙方不对因协议终止或变更而导致的损失负责。</p>
			<p class="bady_care_p">4.6 本合同签订桌数不可减少，甲方在宴会举办日前7日确定是否增加桌数，并确定最终桌数，按最终桌数支付费用（新增桌数，无优惠，按菜金原价计算）。</p>
			<p class="bady_care_p">4.7 乙方提供“一站式”宝宝宴服务，甲方选择该套餐表明甲方认可和接受所选套餐包含的所有服务项目（含赠送项目）。甲方不得将所选套餐包含的服务项目（含赠送项目）用于折抵其他应付款。</p>
			<p class="bady_care_p">4.8 宴会服务由乙方及其关联公司(如需)提供和承办，甲方对此表示认可和同意。</p>

			<p class="bady_care">五、宴会秩序 </p>
			<p>为保证宴会的顺利、安全进行，甲方确认在本协议签订时已知悉以下事项，并承诺宴会期间，甲方及受邀出席宴会的相关人士遵守以下事项：</p>
			<p class="bady_care_p">5.1禁止携带具有爆炸性、易燃性、放射性等危险物品和管制器具等进入宴会会场； </p>
			<p class="bady_care_p">5.2禁止携带狗、猫等动物及其它危险宠物进入宴会会场；</p>
			<p class="bady_care_p">5.3甲方及受邀出席宴会的相关人士应在宴会会场内食用由乙方提供的酒水食物，谢绝任何外带酒水食物，且乙方已明确告知甲方不提供任何打包容器。因甲方及受邀出席宴会的相关人士食用外带食物或自行打包带回食物而引发的问题（包括但不限于食物中毒），与乙方无关。</p>
			<p class="bady_care_p">5.4无民事行为能力人或限制行为能力人必须有监护人在场陪同并尽到监护义务。鉴于“宝宝宴”的特殊性，所有到场的未成年人应有家长（监护人）陪同和监护，并努力维持现场的秩序；若甲方及其受邀出席宴会的家长（监护人）未尽到监护义务，导致发生意外伤害事故，责任由乙方自行承担，与甲方无关。</p>
			<p class="bady_care_p">5.5甲方及受邀出席宴会的相关人士在宴会会场应注意不得损坏或污损乙方会场的设施设备；如有损坏情况发生，甲方将立即修复或按原价向乙方支付赔偿金。</p>
			<p class="bady_care_p">5.6禁止在宴会现场追逐、打闹及其他可能妨碍他人、造成他人人身伤害或财产损失、扰乱宴会现场秩序和危害公共安全的行为。</p>
			<p class="bady_care_p">5.7宴会举办期间，甲方及受邀出席宴会的相关人士应注意保管好随身携带物品，乙方并无任何保管义务；如发生遗失的，损失自行承担。</p>

			<p class="bady_care">六、违约责任 </p>
			<p class="bady_care_p">6.1甲方应按照本协议约定按时足额支付相应款项。甲方逾期支付任意一期款项的，每逾期1日，应向乙方支付应付而未付部分金额千分之一的违约金；逾期超过7日或在宴会举办日前7日仍未付清全款的，乙方有权书面通知甲方解除本协议并参照本协议第6.2条追究甲方的违约责任。 </p>
			<p class="bady_care_p bady_care_p0">6.2如因甲方原因单方面取消预订或因甲方违反本协议约定导致本协议解除的，甲方应按下列情形承 担相应的违约责任：
			</p>
			<table class="table3" width="100%" cellspacing="0" cellpadding="0">
				<tr>
					<td>情形</td>
					<td>违约责任</td>
				</tr>
				<tr>
					<td>签约日至宴会举办日前30日取消</td>
					<td>乙方最高收取合同总价20%的违约金</td>
				</tr>
				<tr>
					<td>宴会举办日前30日至宴会举办日前15日取消</td>
					<td>乙方收取合同总价40%的违约金</td>
				</tr>
				<tr>
					<td>宴会举办日前15日至宴会举办日前7日取消</td>
					<td>乙方收取合同总价60%的违约金</td>
				</tr>
				<tr>
					<td>宴会举办日前7日至宴会举办日前1日取消</td>
					<td>乙方收取合同总价80%的违约金</td>
				</tr>
				<tr>
					<td>宴会举办当日取消的</td>
					<td>乙方收取合同总价100%的违约金</td>
				</tr>
			</table>

			<p class="bady_care_p bady_care_p0">6.3 如因乙方原因单方面取消预订，乙方应按下列情形承担相应的违约责任：</p>
			<table class="table3" width="100%" cellspacing="0" cellpadding="0">
				<tr>
					<td>情形</td>
					<td>违约责任</td>
				</tr>
				<tr>
					<td>签约日至宴会举办日前30日取消</td>
					<td>乙方双倍返还已收定金 </td>
				</tr>
				<tr>
					<td>宴会举办日前30日至宴会举办日前15日取消</td>
					<td>退还已收费用，甲方收取合同总价40%的违约金 </td>
				</tr>
				<tr>
					<td>宴会举办日前15日至宴会举办日前7日取消</td>
					<td>退还已收费用，甲方收取合同总价60%的违约金</td>
				</tr>
				<tr>
					<td>宴会举办日前7日至宴会举办日前1日取消</td>
					<td>退还已收费用，甲方收取合同总价80%的违约金</td>
				</tr>
				<tr>
					<td>宴会举办当日取消的</td>
					<td>退还已收费用，甲方收取合同总价100%的违约金</td>
				</tr>
			</table>

			<p class="bady_care_p">6.4 如甲方违约，乙方有权将已收费用于抵偿违约金、损害赔偿金；不足部分，乙方有权向甲方进一步追偿。</p>
			<p class="bady_care_p">6.5 任意一方违反本协议约定，违约方还需承担守约方为追究该等违约责任所支付的律师费、诉讼费、调查费、差旅费、第三方索赔、行政处罚等。</p>

			<p class="bady_care">七、合同的生效 </p>
			<p class="bady_care_p1">7.1 本合同自双方签字或盖章之日起生效，本合同壹式贰份，具有同等效力。其中甲方持有壹份，乙方持有贰份。本协议附件为本合同的组成部分，具有同等效力。 </p>
			<p class="bady_care_p1">7.2 本协议未尽事宜，甲、乙双方可另行签订补充协议，补充协议与本协议不一致的地方，以补充协议为准。 </p>
			<p class="bady_care_p1">7.3 本协议履行过程中发生争议的，甲、乙双方应友好协商解决；协商不成的，提交有管辖权的人民法院管辖。 </p>

			<p class="bottom_p" style="margin-top:60px;">附件：《服务项目及报价清单》</p>
			<!--<img src="../jsimgcss/images/agreement/again.png" alt="" style="display: inline-block;float: right; margin-top: -140px;margin-right: -60px;">-->
			<table class="table5" width="100%" cellspacing="0" cellpadding="0" style="margin-top:200px;">
				<tr>
					<td>甲方</td>
					<td></td>
					<td>乙方（签章）</td>
					<td></td>
				</tr>
				<tr>
					<td>代表人</td>
					<td></td>
					<td>代表人</td>
					<td></td>
				</tr>
				<tr>
					<td>日期</td>
					<td></td>
					<td>日期</td>
					<td></td>
				</tr>
			</table>

		</div>

	</div>
</template>
<script type="text/ecmascript-6">
    import $ from 'jQuery'
    require("../../../utils/jquery.jqprint-0.3");
    import  moment from 'moment'
    export default {
        props:{
            hsOrderId:{
                type:String
            },
            isPrintPage:{
                type:Boolean
            }
        },
        data(){
            return{
                openCity:[]
            }
        },
        computed:{
            id(){
                return {
                    "hsOrderId":this.hsOrderId
                }
            },
            PrintPage(){
                return this.isPrintPage

            }
        },
        methods:{
            initOpenCity(){ //所有开通城市
                this.$axios.get('/b/getOpenCityLists',{params:{'pageSize':100}}).then((res2)=>{    //获取所有城市列表
                    if(res2.status == 200){
                        this.openCity =  res2.data.msg;
                    }
                    else{
                        alert(msg)
                    }

                })
            },
           DX(n) {
        if (!/^(0|[1-9]\d*)(\.\d+)?$/.test(n)){return "数据非法"};
        var unit = "千百拾亿千百拾万千百拾元角分", str = "";
        n += "00";
        var p = n.indexOf('.');
        if (p >= 0)
            n = n.substring(0, p) + n.substr(p+1, 2);
        unit = unit.substr(unit.length - n.length);
        for (var i=0; i < n.length; i++)
            str += '零壹贰叁肆伍陆柒捌玖'.charAt(n.charAt(i)) + unit.charAt(i);
        return str.replace(/零(千|百|拾|角)/g, "零").replace(/(零)+/g, "零").replace(/零(万|亿|元)/g, "$1").replace(/(亿)万|壹(拾)/g, "$1$2").replace(/^元零?|零分/g, "").replace(/元$/g, "元整");
    },
            dateDiff(date1, date2){
                var strSeparator = "-"; //日期分隔符
                var oDate1;
                var oDate2;
                var iDays;
                oDate1= date1.split(strSeparator);
                oDate2= date2.split(strSeparator);
                var strDateS = new Date(oDate1[0], oDate1[1]-1, oDate1[2]);
                var strDateE = new Date(oDate2[0], oDate2[1]-1, oDate2[2]);
                iDays = parseInt(Math.abs(strDateS - strDateE ) / 1000 / 60 / 60 /24)//把相差的毫秒数转换为天数
                return iDays ;
            },
    initData(){

                this.$axios.post('/order/getHsAgreementBabyDetailsPrint',this.id).then((res)=> {  //获取所有套系
                    //订单详细信息
                    let  orderVo =res.data.msg;

                    //套系信息
                    let   hsAgrPackage = orderVo.hsAgrPackageDTO;
                    //合同信息
                    let  hsAgreementVo = orderVo["hsAgreementDTO"];
                    //款项信息
                    let  hsAgreementFundsVoList = orderVo["hsAgreementFundsList"];
                    //档期信息
                    let   hsScheduleVo = orderVo["hsScheduleList"];

                    //加载合同信息
                    for(let i in hsAgreementVo){
                        $("#"+i).text(hsAgreementVo[i]);
                    }
                    $("#partyB").text(orderVo["companyName"]);
                    $("#partyBAddress").text(orderVo["address"]);
                    $('#estimateTableNumber').text(orderVo.hsAgreementDTO.hsAgrPackageDTO.estimateTableNumber)
                    $('#tableNumber').text(orderVo.hsAgreementDTO.hsAgrPackageDTO.tableNumber)
                    let diningTableFormName=orderVo.hsAgreementDTO.hsAgrPackageDTO.diningTableForm?'长桌':'圆桌'
                    $('#diningTableFormName').text(diningTableFormName)
                    //加载套系信息
                    for(let i in hsAgrPackage){
                        $("#"+i).text(hsAgrPackage[i]);
                    }
                    let  arrList = [];
                    let str ='';
                    let strMideele ="";
                    let scheduleTime =hsScheduleVo[0]["scheduleTime"];
                    let banquetHallName ="";
                    $("#banquetHallName").text(orderVo["hallName"]);
                    $("#scheduleTime").text(scheduleTime);
                    $("#time").text(hsAgreementVo["startTime"]+"-"+hsAgreementVo["endTime"]);
                    if(hsAgreementFundsVoList != null ){
                        let number= 1;
                        for(let j = 0;j<hsAgreementFundsVoList.length; j++){
                            if(hsAgreementFundsVoList[j]["type"] == 2){//款项目为订金
                                if(hsAgreementFundsVoList[j]["amount"] !=null ){
                                    arrList.push('<p class="bady_care_p">3.' + number + ' 本协议签订当日向乙方支付定金人民币'+hsAgreementFundsVoList[j]["amount"]+'元（大写：人民币'+this.DX(hsAgreementFundsVoList[j]["amount"])+'）。</p>');
                                }else{
                                    arrList.push('<p class="bady_care_p">3.' + number + ' 本协议签订当日向乙方支付定金人民币0元（大写：人民币零元）。</p>');
                                }
                                number++;
                            }
                        }
                        for(let j = 0;j<hsAgreementFundsVoList.length; j++){
                            if (hsAgreementFundsVoList[j]["type"] == 3){//款项为中款
                                if(hsAgreementFundsVoList[j]["amount"] !=null && hsAgreementFundsVoList[j]["lastPaymentTime"] != null && hsScheduleVo[0] != null && hsScheduleVo[0]["scheduleTime"] != null) {
                                    let lastPaymentTime3 = moment(hsAgreementFundsVoList[j]["lastPaymentTime"]).format('YYYY-MM-DD');
                                    let days3 = this.dateDiff(lastPaymentTime3,moment(scheduleTime).format('YYYY-MM-DD'));
                                    strMideele += '<p class="bady_care_p">3.' + parseInt(arrList.length + 1) + ' 宴会举办日前'+days3+'日，甲方应向乙方支付中期服务款人民币' + hsAgreementFundsVoList[j]["amount"] + '元（大写：人民币' + this.DX(hsAgreementFundsVoList[j]["amount"]) + '）。';
                                }else{
                                    strMideele += '<p class="bady_care_p">3.' + parseInt(arrList.length + 1) + ' 宴会举办日前180日，甲方应向乙方支付中期服务款人民币0元（大写：人民币零元）；';
                                }
                            }
                        }
                        for(let j = 0;j<hsAgreementFundsVoList.length; j++){
                            if (hsAgreementFundsVoList[j]["type"] == 4){//款项为尾款
                                if(hsAgreementFundsVoList[j]["lastPaymentTime"] !=null ) {
                                    let lastPaymentTime4 = moment(hsAgreementFundsVoList[j]["lastPaymentTime"]).format('YYYY-MM-DD');
                                    let days4 = this.dateDiff(lastPaymentTime4,moment(scheduleTime).format('YYYY-MM-DD'));
                                    if(days4 > 0) {
                                        strMideele += '<p class="bady_care_p">3.' + parseInt(arrList.length + 2) + ' 宴会举办日前'+days4+'日，甲方需确认最终出席人数，并以最终确认的服务金额为依据，付清剩余款项。</p>';
                                    }else {
                                        strMideele += '<p class="bady_care_p">3.' + parseInt(arrList.length + 2) + ' 宴会举办当日{'+ hsAgreementFundsVoList[j]["lastPaymentRemark"]+'}开始前，甲方需确认最终出席人数，并以最终确认的服务金额为依据，付清剩余款项。</p>';
                                    }
                                    strMideele += '<p class="bady_care_p">3.' + parseInt(arrList.length + 3) + ' 宴会举办当日，甲方实际消费金额超过最终确认服务金额的部分，甲方应在宴会结束时';
                                    strMideele +='一次性支付给乙方。</p>';
                                    var cityName;
                                    this.openCity.forEach((e)=>{
                                        if(orderVo["cityCode"]==e.cityCode){
                                            cityName=e.cityName
                                        }
                                    })
                                    strMideele +=' <p class="bady_care_p" style="margin-bottom:30px;">3.'+parseInt(arrList.length + 4) +' 因宴会举办需要，乙方工作人员（包括但不限于摄影、摄像、化妆、司仪）须到'+cityName+'以外地区提供服务的，甲方应按照500元/天/人的标准向乙方支付外地服务费用， 该笔服务费用甲方应于宴会';
                                    if(days4 > 0){
                                        strMideele +='举办日前'+days4+'日，';
                                    }else{
                                        strMideele +='宴会举办当日，';
                                    }
                                    strMideele +='一次性支付给乙方。同时甲方还须承担乙方工作人员的往返交通费、差旅费、食宿费 。</p>';
                                }
                            }
                        }
                    }
                    for(let i = 0 ;i<arrList.length;i++){
                        str +=arrList[i];
                    }
                    str += strMideele;

                    $(".dataGoldDiv").append(str);
                    if(this.PrintPage){
                        $("#ddd").jqprint();
                    }
                })

                }
        },
        mounted(){
            this.initOpenCity()
            this.initData();
        }
    }
</script>
